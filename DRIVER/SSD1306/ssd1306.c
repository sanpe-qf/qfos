#include  "ssd1306.h"

const unsigned  char ASCII_8X16[][16];
const char HTU_8X16[][16];

unsigned char printline=0;

void Oled_PrintLf(char *string)
{
	unsigned char i=0;
	if(printline==4)
	{
		Oled_ClearFull();
		printline=0;
	}
	while(*string)
	{
		ShowASCII_8x16(i*8,printline,ASCII_8X16[*string-32]);
		string++;
		i++;	
		if(i==16){
			printline++;
			i=0;
		}
	}
	printline++;
}
void Oled_Print(unsigned char x,unsigned char y,const  char *string)
{
	unsigned char i=0;
	while(*string)
	{
		ShowASCII_8x16(x+i*8,y,ASCII_8X16[*string-32]);
		string++;
		i++;	
	}
}
void Oled_PrintNumber(unsigned char x,unsigned char y,uchar numberlong,unsigned long long number)
{
}
void Oled_Update(unsigned char *GDDRAM)
{
	unsigned int j;
	WriteCmd(0x21);   
	WriteCmd(0);
	WriteCmd(127);
	WriteCmd(0x22);
	WriteCmd(0);
	WriteCmd(7);
	for(j=0;j<1024;j++)
	    {
				 	WriteDat(*GDDRAM);
			  	GDDRAM++;
			} 
}

void Oled_ClearFull()
{	
	unsigned int j;
	WriteCmd(0x21);   
	WriteCmd(0);
	WriteCmd(127);
	WriteCmd(0x22);
	WriteCmd(0);
	WriteCmd(7);
	for(j=0;j<1024;j++)
	    {
				 	WriteDat(0x00);
			} 
	printline=0;
}


void Oled_Init(void)
{
	unsigned char x,y;
/*********以下为SSD1306设置初始化代码，无需改动**********/	
		WriteCmd(Oled_Set_Display_Off);	//关显示
	
    WriteCmd(0xd5);	//设置显示时钟分频率、振荡器频率
    WriteCmd(0x80);//A[3:0]:分频频率1到16，A[7:4]频率
	
    WriteCmd(0xa8);	//duty设置
    WriteCmd(0x3f);	//duty=1/64
	
    WriteCmd(0xd3);	//显示偏移
		WriteCmd(0x00); //不偏移
/***********默认初始化结束*****************************/

	  //进入用户配置
		WriteCmd(0x40);	//起始行 40~7F

    WriteCmd(0x8d);	//电荷泵设置
	  WriteCmd(0x14); //10:关闭 14:开启

    WriteCmd(0x20);	//设置内存地址模式
    WriteCmd(0x00); //00水平地址模式，01垂直模式，02页地址模式，
 
    WriteCmd(0xc8); //行扫描顺序：从上到下c8	//上下颠倒c0
    WriteCmd(0xa1); //列扫描顺序：从左到右a1	//左右翻转a0

    WriteCmd(0xda); //设置COM口硬件引脚配置
    WriteCmd(0x12);

    WriteCmd(0x81); //微调对比度,本指令的0x81不要改动，改下面的值
    WriteCmd(0x7f); //微调对比度的值，可设置范围0x00～0xff

    WriteCmd(0xd9); //设置预充电周期
    WriteCmd(0xf1); // 

    WriteCmd(0xdb); //Set VCOMH Deselect Level
    WriteCmd(0x30);
		
    WriteCmd(0xa4); //全局显示开启:a5开启; a4关闭
    WriteCmd(0xa6); //设置显示方式:a7,反相显示;a6,正常显示	

    WriteCmd(Oled_Set_Display_On); //开显示

		Oled_ClearFull();

}

void WriteDat(unsigned char IIC_Data)
{
	I2c1_Start();
	I2c1_Sadd(0x78);
	I2c1_Sdata(0x40);			//write data
	I2c1_Sdata(IIC_Data);
	I2c1_Stop();
}


void WriteCmd(unsigned char IIC_Command)
{
	I2c1_Start();
	I2c1_Sadd(0x78);      //Slave address,SA0=0
	I2c1_Sdata(0x00);			//write command
	I2c1_Sdata(IIC_Command);
	I2c1_Stop();
}

void ShowASCII_8x16(unsigned char x,unsigned char y,const unsigned char *word)
{
	unsigned char j;
	WriteCmd(0x21);   
	WriteCmd(x);
	WriteCmd(x+7);
	WriteCmd(0x22);
	WriteCmd(y*2);
	WriteCmd(y*2+1);
	for(j=0;j<16;j++)
	    {
				 	WriteDat(*word);
			  	word++;
			} 
}

/**********************下面为字库***********************************************************/

const unsigned  char ASCII_8X16[][16]={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//32
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*" ",0*/
0x00,0x00,0x00,0xF8,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x33,0x00,0x00,0x00,0x00,/*"!",1*/
0x00,0x10,0x0C,0x02,0x10,0x0C,0x02,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*""",2*/
0x00,0x40,0xC0,0x78,0x40,0xC0,0x78,0x00,
0x00,0x04,0x3F,0x04,0x04,0x3F,0x04,0x00,/*"#",3*/
0x00,0x70,0x88,0x88,0xFC,0x08,0x30,0x00,
0x00,0x18,0x20,0x20,0xFF,0x21,0x1E,0x00,/*"$",4*/
0xF0,0x08,0xF0,0x80,0x60,0x18,0x00,0x00,
0x00,0x31,0x0C,0x03,0x1E,0x21,0x1E,0x00,/*"%",5*/
0x00,0xF0,0x08,0x88,0x70,0x00,0x00,0x00,
0x1E,0x21,0x23,0x2C,0x19,0x27,0x21,0x10,/*"&",6*/
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x90,0x70,0x00,0x00,0x00,0x00,0x00,/*",",7*/
0x00,0x00,0x00,0xE0,0x18,0x04,0x02,0x00,
0x00,0x00,0x00,0x07,0x18,0x20,0x40,0x00,/*"(",8*/
0x00,0x02,0x04,0x18,0xE0,0x00,0x00,0x00,
0x00,0x40,0x20,0x18,0x07,0x00,0x00,0x00,/*")",9*/
0x40,0x40,0x80,0xF0,0x80,0x40,0x40,0x00,
0x02,0x02,0x01,0x0F,0x01,0x02,0x02,0x00,/*"*",10*/
0x00,0x00,0x00,0x00,0xE0,0x00,0x00,0x00,
0x00,0x01,0x01,0x01,0x0F,0x01,0x01,0x01,/*"+",11*/
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x90,0x70,0x00,0x00,0x00,0x00,0x00,/*",",12*/
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x00,/*"-",13*/
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,/*".",14*/
0x00,0x00,0x00,0x00,0xC0,0x38,0x04,0x00,
0x00,0x60,0x18,0x07,0x00,0x00,0x00,0x00,/*"/",15*/
0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,
0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00,/*"0",16*/
0x00,0x00,0x10,0x10,0xF8,0x00,0x00,0x00,
0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,/*"1",17*/
0x00,0x70,0x08,0x08,0x08,0x08,0xF0,0x00,
0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,/*"2",18*/
0x00,0x30,0x08,0x08,0x08,0x88,0x70,0x00,
0x00,0x18,0x20,0x21,0x21,0x22,0x1C,0x00,/*"3",19*/
0x00,0x00,0x80,0x40,0x30,0xF8,0x00,0x00,
0x00,0x06,0x05,0x24,0x24,0x3F,0x24,0x24,/*"4",20*/
0x00,0xF8,0x88,0x88,0x88,0x08,0x08,0x00,
0x00,0x19,0x20,0x20,0x20,0x11,0x0E,0x00,/*"5",21*/
0x00,0xE0,0x10,0x88,0x88,0x90,0x00,0x00,
0x00,0x0F,0x11,0x20,0x20,0x20,0x1F,0x00,/*"6",22*/
0x00,0x18,0x08,0x08,0x88,0x68,0x18,0x00,
0x00,0x00,0x00,0x3E,0x01,0x00,0x00,0x00,/*"7",23*/
0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00,
0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00,/*"8",24*/
0x00,0xF0,0x08,0x08,0x08,0x10,0xE0,0x00,
0x00,0x01,0x12,0x22,0x22,0x11,0x0F,0x00,/*"9",25*/
0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,0x00,
0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,/*":",26*/
0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0xE0,0x00,0x00,0x00,0x00,/*";",27*/
0x00,0x00,0x80,0x40,0x20,0x10,0x08,0x00,
0x00,0x01,0x02,0x04,0x08,0x10,0x20,0x00,/*"<",28*/
0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x00,
0x00,0x02,0x02,0x02,0x02,0x02,0x02,0x00,/*"=",29*/
0x00,0x08,0x10,0x20,0x40,0x80,0x00,0x00,
0x00,0x20,0x10,0x08,0x04,0x02,0x01,0x00,/*">",30*/
0x00,0x70,0x48,0x08,0x08,0x88,0x70,0x00,
0x00,0x00,0x00,0x30,0x37,0x00,0x00,0x00,/*"?",31*/
0xC0,0x30,0xC8,0x28,0xE8,0x10,0xE0,0x00,
0x07,0x18,0x27,0x28,0x2F,0x28,0x17,0x00,/*"@",32*/
0x00,0x00,0xC0,0x38,0xE0,0x00,0x00,0x00,
0x20,0x3C,0x23,0x02,0x02,0x27,0x38,0x20,/*"A",33*/
0x08,0xF8,0x88,0x88,0x88,0x70,0x00,0x00,
0x20,0x3F,0x20,0x20,0x20,0x11,0x0E,0x00,/*"B",34*/
0xC0,0x30,0x08,0x08,0x08,0x08,0x38,0x00,
0x07,0x18,0x20,0x20,0x20,0x10,0x08,0x00,/*"C",35*/
0x08,0xF8,0x08,0x08,0x08,0x10,0xE0,0x00,
0x20,0x3F,0x20,0x20,0x20,0x10,0x0F,0x00,/*"D",36*/
0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,
0x20,0x3F,0x20,0x20,0x23,0x20,0x18,0x00,/*"E",37*/
0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,
0x20,0x3F,0x20,0x00,0x03,0x00,0x00,0x00,/*"F",38*/
0xC0,0x30,0x08,0x08,0x08,0x38,0x00,0x00,
0x07,0x18,0x20,0x20,0x22,0x1E,0x02,0x00,/*"G",39*/
0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,
0x20,0x3F,0x21,0x01,0x01,0x21,0x3F,0x20,/*"H",40*/
0x00,0x08,0x08,0xF8,0x08,0x08,0x00,0x00,
0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,/*"I",41*/
0x00,0x00,0x08,0x08,0xF8,0x08,0x08,0x00,
0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,0x00,/*"J",42*/
0x08,0xF8,0x88,0xC0,0x28,0x18,0x08,0x00,
0x20,0x3F,0x20,0x01,0x26,0x38,0x20,0x00,/*"K",43*/
0x08,0xF8,0x08,0x00,0x00,0x00,0x00,0x00,
0x20,0x3F,0x20,0x20,0x20,0x20,0x30,0x00,/*"L",44*/
0x08,0xF8,0xF8,0x00,0xF8,0xF8,0x08,0x00,
0x20,0x3F,0x01,0x3E,0x01,0x3F,0x20,0x00,/*"M",45*/
0x08,0xF8,0x30,0xC0,0x00,0x08,0xF8,0x08,
0x20,0x3F,0x20,0x00,0x07,0x18,0x3F,0x00,/*"N",46*/
0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,
0x0F,0x10,0x20,0x20,0x20,0x10,0x0F,0x00,/*"O",47*/
0x08,0xF8,0x08,0x08,0x08,0x08,0xF0,0x00,
0x20,0x3F,0x21,0x01,0x01,0x01,0x00,0x00,/*"P",48*/
0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,
0x0F,0x10,0x28,0x28,0x30,0x50,0x4F,0x00,/*"Q",49*/
0x08,0xF8,0x88,0x88,0x88,0x88,0x70,0x00,
0x20,0x3F,0x20,0x00,0x03,0x0C,0x30,0x20,/*"R",50*/
0x00,0x70,0x88,0x08,0x08,0x08,0x38,0x00,
0x00,0x38,0x20,0x21,0x21,0x22,0x1C,0x00,/*"S",51*/
0x18,0x08,0x08,0xF8,0x08,0x08,0x18,0x00,
0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,/*"T",52*/
0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,
0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,/*"U",53*/
0x08,0x78,0x88,0x00,0x00,0xC8,0x38,0x08,
0x00,0x00,0x07,0x38,0x0E,0x01,0x00,0x00,/*"V",54*/
0x08,0xF8,0x00,0xF8,0x00,0xF8,0x08,0x00,
0x00,0x03,0x3E,0x01,0x3E,0x03,0x00,0x00,/*"W",55*/
0x08,0x18,0x68,0x80,0x80,0x68,0x18,0x08,
0x20,0x30,0x2C,0x03,0x03,0x2C,0x30,0x20,/*"X",56*/
0x08,0x38,0xC8,0x00,0xC8,0x38,0x08,0x00,
0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,/*"Y",57*/
0x10,0x08,0x08,0x08,0xC8,0x38,0x08,0x00,
0x20,0x38,0x26,0x21,0x20,0x20,0x18,0x00,/*"Z",58*/
0x00,0x00,0x00,0xFE,0x02,0x02,0x02,0x00,
0x00,0x00,0x00,0x7F,0x40,0x40,0x40,0x00,/*"[",59*/
0x00,0x04,0x38,0xC0,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x01,0x06,0x38,0xC0,0x00,/*"\",60*/
0x00,0x02,0x02,0x02,0xFE,0x00,0x00,0x00,
0x00,0x40,0x40,0x40,0x7F,0x00,0x00,0x00,/*"]",61*/
0x00,0x00,0x04,0x02,0x02,0x04,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"^",62*/
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x00,/*"-",63*/
0x00,0x02,0x02,0x04,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"`",64*/
0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x00,
0x00,0x19,0x24,0x24,0x12,0x3F,0x20,0x00,/*"a",65*/
0x10,0xF0,0x00,0x80,0x80,0x00,0x00,0x00,
0x00,0x3F,0x11,0x20,0x20,0x11,0x0E,0x00,/*"b",66*/
0x00,0x00,0x00,0x80,0x80,0x80,0x00,0x00,
0x00,0x0E,0x11,0x20,0x20,0x20,0x11,0x00,/*"c",67*/
0x00,0x00,0x80,0x80,0x80,0x90,0xF0,0x00,
0x00,0x1F,0x20,0x20,0x20,0x10,0x3F,0x20,/*"d",68*/
0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,
0x00,0x1F,0x24,0x24,0x24,0x24,0x17,0x00,/*"e",69*/
0x00,0x80,0x80,0xE0,0x90,0x90,0x20,0x00,
0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,/*"f",70*/
0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,
0x00,0x6B,0x94,0x94,0x94,0x93,0x60,0x00,/*"g",71*/
0x10,0xF0,0x00,0x80,0x80,0x80,0x00,0x00,
0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20,/*"h",72*/
0x00,0x80,0x98,0x98,0x00,0x00,0x00,0x00,
0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,/*"i",73*/
0x00,0x00,0x00,0x80,0x98,0x98,0x00,0x00,
0x00,0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,/*"j",74*/
0x10,0xF0,0x00,0x00,0x80,0x80,0x80,0x00,
0x20,0x3F,0x24,0x06,0x29,0x30,0x20,0x00,/*"k",75*/
0x00,0x10,0x10,0xF8,0x00,0x00,0x00,0x00,
0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,/*"l",76*/
0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,
0x20,0x3F,0x20,0x00,0x3F,0x20,0x00,0x3F,/*"m",77*/
0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x00,
0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20,/*"n",78*/
0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,
0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,/*"o",79*/
0x80,0x80,0x00,0x80,0x80,0x00,0x00,0x00,
0x80,0xFF,0x91,0x20,0x20,0x11,0x0E,0x00,/*"p",80*/
0x00,0x00,0x00,0x80,0x80,0x00,0x80,0x00,
0x00,0x0E,0x11,0x20,0x20,0x91,0xFF,0x80,/*"q",81*/
0x80,0x80,0x80,0x00,0x80,0x80,0x80,0x00,
0x20,0x20,0x3F,0x21,0x20,0x00,0x01,0x00,/*"r",82*/
0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,
0x00,0x33,0x24,0x24,0x24,0x24,0x19,0x00,/*"s",83*/
0x00,0x80,0x80,0xE0,0x80,0x80,0x00,0x00,
0x00,0x00,0x00,0x1F,0x20,0x20,0x10,0x00,/*"t",84*/
0x80,0x80,0x00,0x00,0x00,0x80,0x80,0x00,
0x00,0x1F,0x20,0x20,0x20,0x10,0x3F,0x20,/*"u",85*/
0x80,0x80,0x80,0x00,0x80,0x80,0x80,0x00,
0x00,0x03,0x0C,0x30,0x0C,0x03,0x00,0x00,/*"v",86*/
0x80,0x80,0x00,0x80,0x80,0x00,0x80,0x80,
0x01,0x0E,0x30,0x0C,0x07,0x38,0x06,0x01,/*"w",87*/
0x00,0x80,0x80,0x80,0x00,0x80,0x80,0x00,
0x00,0x20,0x31,0x0E,0x2E,0x31,0x20,0x00,/*"x",88*/
0x80,0x80,0x80,0x00,0x00,0x80,0x80,0x80,
0x00,0x81,0x86,0x78,0x18,0x06,0x01,0x00,/*"y",89*/
0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x00,
0x00,0x21,0x30,0x2C,0x22,0x21,0x30,0x00,/*"z",90*/
0x00,0x00,0x00,0x00,0x00,0xFC,0x02,0x02,
0x00,0x00,0x00,0x00,0x01,0x3E,0x40,0x40,/*"{",91*/
0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,/*"|",92*/
0x02,0x02,0xFC,0x00,0x00,0x00,0x00,0x00,
0x40,0x40,0x3E,0x01,0x00,0x00,0x00,0x00,/*"}",93*/
0x00,0x02,0x01,0x02,0x02,0x04,0x02,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"~",94*/

};

const char HTU_8X16[][16]={
0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,
0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00,/*"0",0*/
0x00,0x00,0x10,0x10,0xF8,0x00,0x00,0x00,
0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,/*"1",1*/
0x00,0x70,0x08,0x08,0x08,0x08,0xF0,0x00,
0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,/*"2",2*/
0x00,0x30,0x08,0x08,0x08,0x88,0x70,0x00,
0x00,0x18,0x20,0x21,0x21,0x22,0x1C,0x00,/*"3",3*/
0x00,0x00,0x80,0x40,0x30,0xF8,0x00,0x00,
0x00,0x06,0x05,0x24,0x24,0x3F,0x24,0x24,/*"4",4*/
0x00,0xF8,0x88,0x88,0x88,0x08,0x08,0x00,
0x00,0x19,0x20,0x20,0x20,0x11,0x0E,0x00,/*"5",5*/
0x00,0xE0,0x10,0x88,0x88,0x90,0x00,0x00,
0x00,0x0F,0x11,0x20,0x20,0x20,0x1F,0x00,/*"6",6*/
0x00,0x18,0x08,0x08,0x88,0x68,0x18,0x00,
0x00,0x00,0x00,0x3E,0x01,0x00,0x00,0x00,/*"7",7*/
0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00,
0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00,/*"8",8*/
0x00,0xF0,0x08,0x08,0x08,0x10,0xE0,0x00,
0x00,0x01,0x12,0x22,0x22,0x11,0x0F,0x00,/*"9",9*/
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00,/*".",10*/
0xF0,0x08,0xF0,0x80,0x60,0x18,0x00,0x00,
0x00,0x31,0x0C,0x03,0x1E,0x21,0x1E,0x00,/*"%",11*/

};